ðŸ”„ Stored Procedures (PROCEDURE)

Uma Stored Procedure Ã© um conjunto de comandos SQL armazenados no banco de dados, permitindo a execuÃ§Ã£o de processos mais complexos de forma eficiente.

use streamflow;

ðŸ“Œ Criando uma Procedure para adicionar clientes

# 1) Procedure : Inserir um novo filme
DELIMITER //

CREATE PROCEDURE AdicionarFilme(
    IN p_titulo VARCHAR(50),
    IN p_genero CHAR(50),  
    IN p_duracao INT,
    IN p_ano_lancamento YEAR,
    IN p_classificacao_indicativa VARCHAR(10),
    IN p_diretor VARCHAR(50),
    IN p_sinopse VARCHAR(100),
    IN p_legenda VARCHAR(20),
    IN p_dublagem VARCHAR(20)
)
BEGIN
    INSERT INTO filme (titulo, genero, duracao, ano_lancamento, classificacao_indicativa, diretor, sinopse, legenda, dublagem)
    VALUES (p_titulo, p_genero, p_duracao, p_ano_lancamento, p_classificacao_indicativa, p_diretor, p_sinopse, p_legenda, p_dublagem);
END //

DELIMITER ;

ðŸ”¹ Essa Procedure insere um novo filme na tabela filme usando parÃ¢metros.

ðŸ“Œ Executando a Procedure

CALL AdicionarFilme(
    'O Grande Truque',              # TÃ­tulo do filme
    'Drama',                        # GÃªnero
    130,                            # DuraÃ§Ã£o em minutos
    2006,                           # Ano de lanÃ§amento
    '12 anos',                      # ClassificaÃ§Ã£o indicativa
    'Christopher Nolan',            # Diretor
    'Dois mÃ¡gicos rivais competem para criar o truque perfeito.', # Sinopse
    'PortuguÃªs',                    # Legenda
    'InglÃªs'                        # Dublagem
);

select * from filme;

ðŸ“Œ Excluindo uma Procedure

DROP PROCEDURE AdicionarFilme;

# 2) Procedure : Atualizar preÃ§o de um plano

DELIMITER $$
CREATE PROCEDURE atualizar_preco_plano(
    IN p_id_plano INT,
    IN p_novo_preco DECIMAL(5,2)
)
BEGIN
    UPDATE plano
    SET preco = p_novo_preco
    WHERE id_plano = p_id_plano;
END $$
DELIMITER ;

call atualizar_preco_plano(1, 99.99);

select * from plano;


